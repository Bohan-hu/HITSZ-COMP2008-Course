# 附录 A 改进的 Booth 算法（选做）

## 一、实验原理

如果$n$是偶数，我们可以把$[x\cdot y]_\text{补}$ 写成：
$$
\begin{aligned}
\hspace{0pt}
        [x\cdot y]_\text{补} & =[x]_\text{补}\left((y_1-y_0)+(y_2-y_1)2^{-1}+\cdots+(y_n-y_{n-1})2^{-(n-1)}+(y_{n+1}-y_{n})2^{-n}\right) \\
                      & =[x]_\text{补}\left((-2y_0+y_1+y_2)2^{-1}+\cdots+(-2y_{n-1}+y_n+y_{n+1})2^{-n}\right)                     \\
    \end{aligned}
$$

于是可以列出
$$
\begin{aligned}
\hspace{0pt}
        [z_0]_\text{补}                 & =0                                                                               \\
        [z_2]_\text{补}                 & =2^{-2}\cdot \left( [z_0]_\text{补}+(-2y_{n-1}+y_n+y_{n+1})[x]_\text{补} \right)               \\
        \vdots\\
        [z_k]_\text{补}                 & =2^{-2}\cdot \left( [z_{k-2}]_\text{补}+(-2y_{n-k+1}+y_{n-k+2}+y_{n-k+3})[x]_\text{补} \right) \\
        \vdots\\
        [z_{n-2}]_\text{补}             & =2^{-2}\cdot \left( [z_{n-4}]_\text{补}+(-2y_3+y_4+y_5)[x]_\text{补} \right)                   \\
        [x\cdot y]_\text{补}=[z_{n}]_\text{补} & =[z_{n-2}]_\text{补}+(-2y_0+y_1+y_2)[x]_\text{补}                                              \\
    \end{aligned}
$$

所以$y_iy_{i+1}y_{i+2}$对部分积的影响为

| $y_iy_{i+1}y_{i+2}$ | $-2y_i+y_{i+1}+y_{i+2}$ | 右移 **2** 位前对部分积的操作 |
| :-----------------: | :---------------------: | :-------------------------- |
|        0 0 0        |            0            | $+0$                        |
|        0 0 1        |            1            | $+[x]_\text{补}$            |
|        0 1 0        |            1            | $+[x]_\text{补}$            |
|        0 1 1        |            2            | $+2[x]_\text{补}$           |
|        1 0 0        |           -2            | $-2[x]_\text{补}$           |
|        1 0 1        |           -1            | $-[x]_\text{补}$            |
|        1 1 0        |           -1            | $-[x]_\text{补}$            |
|        1 1 1        |            0            | $+0$                        |


## 二、实验要求

编写 Verilog 代码，使用改进的 Booth 算法完成前述实验。

测试框架同上述，但会 **对乘法计算的周期** 进行考察，要求在6周期以内出结果。

登录网站进行提交，模块名仍然为`booth`，且不改变原有模块的IO定义。

